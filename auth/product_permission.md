# Определение прав на продукт

Общий список продуктов, доступных клиенту ведется на уровне узла с типом client.  
Если продукт доступен для продажи всем учеткам этого клиента, то можно указать права на уровне клиента, иначе все права отключены, только список.  
    
Права на продукт определяется по узлу с типом account, sub.

## Алгоритм для account
Проверить что есть запись в account_product для этого account.
Если есть, то вернуть этот набор.
Если нет, то подняться по дереву, id = parent_id.
Как только для узла найдется запись в account_product, вернуть ее.
Останавливаемся на узле с типом client. Если и на этом узле нет продукта, значит он недоступен для клиента.

## Алгоритм для sub
Проверить что есть запись в account_product для этого sub.
Если записи нет, то по дереву не поднимаемся.

## ADR
1. Поиск прав ведем по дереву, от account до client. Если когда то буду проблемы с нагрузкой, то добавим клиентский кэш.   

