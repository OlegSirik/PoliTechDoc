# Договор
Договор состоит из нескольких обязательных частей
1. Шапки
2. Страхователя
3. Объекта страхования

В текущей версии поддерживаются только договоры с одним объектом страхования.

## Шапка
### Даты
1. issueDate - дата продажи договора. Для АПИ интеграций равна текущей дате и времени. Передается с таймзоной. Датее именно это таймзона используется во всем договоре.
2. startDate - дата начала действия договора страхования.
3. endDate - дата окончания действия договора страхования.

Таймзона - для корректного расчета даты начала и окончания договора страхования необъодима информация о таймзоне, в которой продан договор. Эта информация берется из аттрибута issueDate.
Далее дата и время начала и окончания периода действия договора идет в этой таймзоне.

### Настройка продукта 
В продукте даты начала и окончания действия договора или рассчитываются или валидируются.
Для дат и периодов используется формат [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)
#### startDate
Если в продукте нет жесткого правила расчета даты начала договора, то указывается диапазаон, в который должна попадать дата начала. 
Например, если договор может начать действовать в течении 30 дней с даты продажи, то указывается диапазон P0D-P30D 
```
  "waitingPeriod": {
    "validatorType": "RANGE",
    "validatorValue": "P0D-P30D"
  }
```
Если договор всегда начинает действовать через 14 дней после даты оплаты, то указывается список возможных периодов, через ",".
```
  "waitingPeriod": {
    "validatorType": "LIST",
    "validatorValue": "P1D, P14D"
  }
```
Третий тип, задающий правило формирования даты начала договора, это "первое число следйющего месяца".
Другие правила будут добавлятся в процессе эксплуатации.

#### endDate
Для даты окончания договора используется только первые два правила - диапазон или список периодов.

## Линия бизнеса
Выбирается из справочника. Определяет тип страхователя, объект страхования, список доступных покрытий.

## Генератор номера договора
Настройка генератора номеров включает в себя несколько шагов -
1. Маска договора 
Маска договора это строка, собранная из нескольких частей, где каждая часть это значение аттрибута договора или строковая константа.
Аттрибуты договора заключаются в "{}" и указывается название аттрибута из словаря.
Так же есть несколько фиксированных атрибутов - {YY}, {YYYY} это текущий год, {XX} это значение из сиквенса. Можно указать любую необходимую длину, указач несколько X.
Номер будет выравнен 0 слева.
Например
```
{YY}QWERTY{XXXXXXXX}
{25}QWERTY{00000001}
```
2. Максимальное значение - при достижении этого значения сиквенс сбросится в 1. Можно не заполнять.
3. Политика сброка номера сиквенса YEARLY|MONTHLY. При смене года или месяца номер сиквенса сбросится в 1. Можно не заполнять.
4. xorKey - позволяет применить к номеру сиквенса побитовую операцию XOR. Это позволяет получать псевдослучайные числа, если не нравится, что номер договра увеличивается линейно.
